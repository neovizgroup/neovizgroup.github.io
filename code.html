<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Capture Photo iRose</title>
    <meta name="description" content="Capture photo iRose">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#3366ff">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="capture.irose.css">
    <link rel="icon" type="image/png" href="icons/Logo_irose_cs-48x48.png">
  <title>Capture Photo iRose</title>
</head>
<body>
  <header>
    <h1>Capture Photo iRose</h1>
  </header>

  <div class="camera-container" id="camera-container">
    <video id="video" autoplay playsinline></video>
    <canvas id="canvas"></canvas>

    <div class="top-right-buttons">
      <button title="Menu" id="menuBtn" onclick="document.getElementById('menuDialog').showModal();">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <line x1="4" y1="6" x2="20" y2="6"></line>
          <line x1="4" y1="12" x2="20" y2="12"></line>
          <line x1="4" y1="18" x2="20" y2="18"></line>
        </svg>
      </button>
      <button title="Galerie" id="galleryBtn">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
          <circle cx="8.5" cy="8.5" r="1.5"></circle>
          <path d="M21 15l-5-5L5 21"></path>
        </svg>
      </button>
      <button title="Synchroniser" id="syncBtn">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path d="M21 12a9 9 0 0 1-9 9"></path>
          <path d="M21 12a9 9 0 0 0-9-9"></path>
          <path d="M3 12h.01"></path>
          <path d="M7 12h.01"></path>
          <path d="M11 12h.01"></path>
        </svg>
      </button>
    </div>
    <div class="capture-button" id="captureBtn">
      <div class="capture-button-inner"></div>
    </div>
  </div>
  <dialog id="menuDialog">
            <div class="controls">
                <button id="closeMenuBtn" onclick="document.getElementById('menuDialog').close();">
					<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
						<line x1="18" y1="6" x2="6" y2="18"></line>
						<line x1="6" y1="6" x2="18" y2="18"></line>
					</svg>
					Fermer
                </button>
           </div>
			<button id="installBtn" style="display: none;" >
				<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
					<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
					<polyline points="7 10 12 15 17 10"></polyline>
					<line x1="12" y1="15" x2="12" y2="3"></line>
				</svg>
				Installer l'application
			</button>            
            <div class="status">
                <h3>
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="8" x2="12" y2="12"></line>
                        <line x1="12" y1="16" x2="12.01" y2="16"></line>
                    </svg>
                    Statut
                </h3>
                <div class="status-item">
                    <span>Caméra:</span>
                    <span id="cameraStatus" class="status-value">Initialisation...</span>
                </div>
                <div class="status-item">
                    <span>Géolocalisation:</span>
                    <span id="locationStatus" class="status-value">Non demandée</span>
                </div>
                <div class="status-item">
                    <span>Stockage:</span>
                    <span id="storageStatus" class="status-value">Initialisation...</span>
                </div>
                <div class="status-item">
                    <span>Réseau:</span>
                    <span id="networkStatus" class="status-value">Vérification...</span>
                </div>
                <div class="status-item">
                    <span>Installation:</span>
                    <span id="installStatus" class="status-value">Non disponible</span>
                </div>
            </div>
            
            <h3>Photos récentes</h3>
            <div class="gallery" id="gallery">
                <!-- Les photos capturées seront affichées ici -->
            </div>
        </div>
  </dialog>
    <script>
        // Initialiser l'application au chargement
        document.addEventListener('DOMContentLoaded', () => {
            // Si le script externe est chargé correctement, l'application démarrera automatiquement
            if (typeof iRoseApp !== 'undefined' && iRoseApp.init) {
                iRoseApp.init();
            } else {
                console.error('Le script irose.js n\'a pas été chargé correctement');
                document.getElementById('notification').textContent = 'Erreur de chargement de l\'application';
                document.getElementById('notification').classList.add('show');
            }
        });
    </script>

  <script src="irose.js"></script>
</body>
</html>
